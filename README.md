# Настройки
Настройки соединения с базой лежат в файле [`configs/config.php`](configs/config.php)

Зайти в phpMyAdmin, создать новую базу, импортировать туда [shop_lab.sql](shop_lab.sql)



# 3 лаба (работа с корзиной)
1. как происходит взаимодействие с сервером при нажатии кнопки?  
   
    Кнопки, инициирующие действия с корзиной - это элементы с классом `item_add` и атрибутом `data-id`. В `data-id` хранится id товара.  
    На всех таких кнопках висит обработчик [cart.js](/views/js/cart.js#L3-L13) .   
    По клику на кнопке обработчик [вытаскивает id товара из атрибута `data-id`](/views/js/cart.js#L4)  
    и отправляет на адрес `/cart/add/$id` [`post`-запрос](/views/js/cart.js#L5)

    Данный урл будет обрабатываться `CartController` и ему будет соответствовать экшн `actionAdd()`  
    см [соответствующий роут](configs/routes.php#L27)
    

2. какой запрос отправляется, какакя инфа приходит на сервер?  
   - При добавлении товара:  
    `post`-запрос на адрес `/cart/add/$id`,  
    На сервер приходит только id товара.   

    - При удалении товара:  
    `post`-запрос на адрес `/cart/remove/$id`, только id товара

    - При очистке корзины (кнопка в шапке):  
    `post`-запрос на адрес `/cart/clear/`, запрос без доп данных
    
    В реальном времени запром отследить можно через Chrome DevTools на вкладке Network (ctrl+shift+I или F12 - выбрать вручную вкладку Network).  

3. какой класс принимает запрос?  
   Принимает [`CartController`](controllers/CartController.php), обрабатывает класс [`Cart`](models/Cart.php)

4. какой ответ возвращает?  
    Количество товаров в корзине и сумму корзины. В формате `json`(см [`json_encode`](controllers/CartController.php#L38) в `returnResult`).  
    Это можно отследить по коду 
    [CartConstroller->actionAdd](controllers/CartController.php#L9) -> [CartConstroller::returnResult()](controllers/CartController.php#L34-39)
5. что записывается в сессию?  
    состав корзины и сумма корзины (чтобы не пересчитывать ее каждый раз)  
    Состав корзины хранится в ассоциативном массиве типа
    ```json
    {
        id : count,
        id2 : count2
    }
    ```
    т.е. только id товара и его количество
6. где обновляется корзина на клиенте? когда она обновляется?
   При каждой загрузке страницы, при добавлении товаров в корзину, при удалении товаров из корзины.  
   Собсно см код всех 4 обработчиков в [`cart.js`](/views/js/cart.js#L4) )
7. покажи, где написано, что мы ждем ответа  
   jquery-функция $.post() в нашем коде везде принимает два параметра: 
   - url, на который отправляется запрос,
   - функцию, которая выполнится при успешно отправленном запроcе.  
   Эта функция получает с сервера данные (`data` - там всегда количиство товаров и сумма корзины) и обновляет в соответствии с ними корзину в шапке

